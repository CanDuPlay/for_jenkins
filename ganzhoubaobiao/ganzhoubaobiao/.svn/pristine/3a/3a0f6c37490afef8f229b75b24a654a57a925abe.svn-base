webpackJsonp([5],{je5i:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("J8vU");var n=a("1/Ac"),s=(Boolean,{data:function(){return{form:{},yearList:[],statusOptions:[{value:"",label:"全部"},{value:"1",label:"未开始"},{value:"2",label:"进行中"},{value:"3",label:"已完成"}],year:"",status:"",projectName:"",tableData:[]}},computed:{isShow:{get:function(){return this.show},set:function(t){this.$emit("update:show",t)}}},props:{show:{type:Boolean,default:!1},data:{}},mounted:function(){var t=this;this.$nextTick(function(){t.initYear(),t.init()})},methods:{init:function(){var t=this;this.$post("/web/queryProjectList",{year:this.year,status:this.status,projectName:this.projectName,size:1e3}).then(function(e){0==e.resultCode&&(t.tableData=e.content.page.content)})},initYear:function(){var t=this;this.$post("/web/queryProjectYears",{}).then(function(e){0==e.resultCode&&(t.yearList=e.content.list)})},look:function(t){this.isShow=!1,this.$parent.projectId=t,this.$parent.queryYearInit(),this.$parent.queryStage(),sessionStorage.setItem("kanbanProjectId",t)}}}),o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"common-modal",attrs:{title:"切换项目",visible:t.isShow,width:"800px"},on:{"update:visible":function(e){t.isShow=e}}},[a("el-form",{attrs:{inline:!0,model:t.form}},[a("el-form-item",{attrs:{label:"选择项目时间"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"项目时间"},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}},t._l(t.yearList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{placeholder:"项目状态"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},t._l(t.statusOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-form-item",[a("el-input",{staticClass:"input-with-select",staticStyle:{width:"280px"},attrs:{placeholder:"请输入关键字"},model:{value:t.projectName,callback:function(e){t.projectName=e},expression:"projectName"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){return t.init()}},slot:"append"})],1)],1)],1),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"70"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"项目名称"}}),t._v(" "),a("el-table-column",{attrs:{label:"建设时段"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n          "+t._s(t._f("YYYY")(a.startTime))+" - "+t._s(t._f("YYYY")(a.endTime))+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[a("el-button",{attrs:{type:"text"},on:{click:function(e){return t.look(n.id)}}},[t._v("查看")])]}}])})],1),t._v(" "),a("div",{staticClass:"dialog-footer text-center",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isShow=!1}}},[t._v("关闭")])],1)],1)},staticRenderFns:[]};var r=a("VU/8")(s,o,!1,function(t){a("rGGE")},null,null).exports,l={name:"",components:{vToggleProject:r},data:function(){return{yearList:[],year:"",monthList:[{value:"01",label:"1"},{value:"02",label:"2"},{value:"03",label:"3"},{value:"04",label:"4"},{value:"05",label:"5"},{value:"06",label:"6"},{value:"07",label:"7"},{value:"08",label:"8"},{value:"09",label:"9"},{value:"10",label:"10"},{value:"11",label:"11"},{value:"12",label:"12"}],month:"",stageList:[],stage:"",radioState:0,tableData:[],countData:[],ifCheck:sessionStorage.getItem("ifCheck"),lastStatus:sessionStorage.getItem("lastStatus"),nextStatus:sessionStorage.getItem("nextStatus"),status:sessionStorage.getItem("status"),CITY:1,DISTRICT:2,SCHOOL:3,showSchool:!0,showSchoolInfo:!0,toggleProject:!1,projectData:[],projectId:""}},computed:{tMenu:function(){return this.tableData[0].scheduleList}},created:function(){},mounted:function(){this.$nextTick(function(){console.log(sessionStorage.getItem("kanbanProjectId")),"undefined"==sessionStorage.getItem("kanbanProjectId")||null==sessionStorage.getItem("kanbanProjectId")?this.initProject():(this.projectId=sessionStorage.getItem("kanbanProjectId"),this.queryYearInit(),this.queryStage())})},methods:{handlerRadioChange:function(t){switch(console.log(t),t){case 0:this.showSchool=!0,this.showSchoolInfo=!0;break;case 1:this.showSchool=!1,this.showSchoolInfo=!0;break;case 2:this.showSchool=!1,this.showSchoolInfo=!1}},initProject:function(){var t=this,e=this;this.$post("/web/queryProjectList",{year:"",status:"",projectName:"",pageSize:1e3}).then(function(a){0==a.resultCode&&(console.log(e.projectData),e.projectData=a.content.page.content,e.projectId=e.projectData[0].id,e.queryYearInit(),t.queryStage(),sessionStorage.setItem("kanbanProjectId",e.projectId))})},queryStage:function(){var t=this;this.$post("/web/queryStage",{projectId:t.projectId}).then(function(e){t.stageList=e.content.list,t.stageList.unshift({id:"",name:"请选择"})})},queryInit:function(){var t=this;this.$post("/web/kanbanList",{projectId:t.projectId,month:t.year+"-"+t.month,status:t.lastStatus,level:"1",stage:t.stage}).then(function(e){t.tableData=e.content.list})},queryCountInit:function(){var t=this;this.$post("/web/kanbanCount",{projectId:t.projectId,month:t.year+"-"+t.month,status:t.lastStatus,level:"1",stage:t.stage}).then(function(e){t.countData=e.content.list})},queryYearInit:function(){var t=this;this.$post("/web/queryYear",{projectId:t.projectId}).then(function(e){t.yearList=e.content.list,t.year=e.content.year,t.month=e.content.month,t.queryInit(),t.queryCountInit()})},change:function(){this.queryInit(),this.queryCountInit()},check:function(t){var e=this;e.$post("/web/checkStatus",{checkType:0,status:t,lastStatus:e.lastStatus,projectId:e.projectId,month:e.year+"-"+e.month}).then(function(t){e.$message({type:"success",message:"审核成功!"})}).catch(function(t){})},openSchoolInfo:function(t,e){t.target;e.level==this.DISTRICT?this.getChildren(".school_"+e.id):e.level==this.SCHOOL&&this.getChildren(".school-info_"+e.townId)},getChildren:function(t){var e=document.querySelector("#spectaculars-table").querySelectorAll(t);console.log(e),e.forEach(function(t){Object(n.c)(t,"hide")?Object(n.e)(t,"hide"):Object(n.a)(t,"hide")})},rowMerge:function(t){return t.invertedList?4:1},setRowClass:function(t){return t.level==this.DISTRICT?"district":t.level==this.SCHOOL?"school_"+t.id:void 0}}},i={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"spectaculars-wrapper"},[n("div",{staticClass:"spectaculars-head"},[n("section",{staticClass:"check-button"},[1==t.ifCheck?n("el-button",{attrs:{type:"primary",icon:"el-icon-upload",size:" "},on:{click:function(e){return t.check(t.status)}}},[t._v("核实上报")]):t._e(),t._v(" "),1==t.ifCheck?n("el-button",{attrs:{type:"warning",icon:"el-icon-warning",size:" "},on:{click:function(e){return t.check(0)}}},[t._v("警告按钮")]):t._e()],1),t._v(" "),n("section",{staticClass:"title-bar margin-bottom__small"},[t._v("\n\t\t\t\t赣州市城乡学校建设三年行动计划\n\t\t\t\t"),n("el-select",{staticClass:"other-select-style",staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},on:{change:function(e){return t.change()}},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}},t._l(t.yearList,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v("\n\t\t\t\t年度实施项目\n\t\t\t\t"),n("el-select",{staticClass:"other-select-style",staticStyle:{width:"80px"},attrs:{placeholder:"请选择"},on:{change:function(e){return t.change()}},model:{value:t.month,callback:function(e){t.month=e},expression:"month"}},t._l(t.monthList,function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1),t._v("\n\t\t\t\t月进度调度看板\n\t\t\t")],1)]),t._v(" "),n("div",{staticClass:"spectaculars-operation clearfix margin-bottom__medium"},[n("el-select",{staticClass:"margin-right__medium",staticStyle:{width:"160px"},on:{change:function(e){return t.change()}},model:{value:t.stage,callback:function(e){t.stage=e},expression:"stage"}},t._l(t.stageList,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),t._v(" "),n("el-radio-group",{staticClass:"margin-right__medium",on:{change:t.handlerRadioChange},model:{value:t.radioState,callback:function(e){t.radioState=e},expression:"radioState"}},[n("el-radio",{attrs:{label:0}},[t._v("只看区")]),t._v(" "),n("el-radio",{attrs:{label:1}},[t._v("校级数据")]),t._v(" "),n("el-radio",{attrs:{label:2}},[t._v("全部展开")])],1),t._v(" "),n("div",{staticClass:"operation-info margin-left__medium"},[t._v("\n\t\t\t\t\n\t\t\t\t项目总数："),n("span",{staticStyle:{color:"#303133"}},[t._v(t._s(t.countData[0].count))]),t._v(" "),t._l(t.countData,function(e,a){return a>0?n("span",[n("b",[t._v(" | ")]),t._v(t._s(null==e.name?"未申报":e.name)+"："+t._s(e.count))]):t._e()})],2),t._v(" "),n("div",{staticClass:"right-button pull-right"},[n("el-popover",{staticStyle:{"margin-right":"10px"},attrs:{placement:"bottom",width:"200",trigger:"click"}},[n("img",{attrs:{src:a("7Otq"),alt:""}}),t._v(" "),n("el-button",{attrs:{slot:"reference",type:"primary"},slot:"reference"},[t._v("手机二维码")])],1),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.toggleProject=!0}}},[t._v("切换项目")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push({path:"/SpectacularsMonthly"})}}},[t._v("各月数据对比")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push({path:"/SpectacularsYears"})}}},[t._v("年度排名表")])],1)],1),t._v(" "),t.tableData.length?n("div",{staticClass:"spectaculars-table-wrap"},[n("table",{staticClass:"table multifunction-table",attrs:{id:"spectaculars-table"}},[n("thead",[n("tr",[n("th",{attrs:{rowspan:"2"}},[t._v("序号")]),t._v(" "),n("th",{attrs:{rowspan:"2"}},[t._v("项目学校")]),t._v(" "),n("th",{attrs:{colspan:"4"}},[t._v("项目基本情况")]),t._v(" "),n("th",{attrs:{colspan:"2"}},[t._v("建设时限情况")]),t._v(" "),n("th",{attrs:{colspan:t.tMenu.length}},[t._v("项目形象进度情况")]),t._v(" "),t._m(0),t._v(" "),n("th",{attrs:{rowspan:"2"}},[t._v("责任单位")]),t._v(" "),n("th",{attrs:{rowspan:"2"}},[t._v("市教育局定点联系领导")]),t._v(" "),n("th",{attrs:{rowspan:"2"}},[t._v("市教育局总负责")])]),t._v(" "),n("tr",[n("th",[t._v("学校类型")]),t._v(" "),n("th",[t._v("建筑面积")]),t._v(" "),n("th",[t._v("新增学位")]),t._v(" "),t._m(1),t._v(" "),n("th",[t._v("开工年份")]),t._v(" "),n("th",[t._v("竣工年份")]),t._v(" "),t._l(t.tMenu,function(e,a){return n("th",{key:a,style:{backgroundColor:e.color}},[t._v("\n\t\t\t\t\t\t\t"+t._s(e.name)+"\n\t\t\t\t\t\t")])})],2)]),t._v(" "),t._l(t.tableData,function(e,a){return n("tbody",{key:a,class:[t.setRowClass(e),"row-school-info_bgcolor",{hide:t.showSchool&&e.level==t.SCHOOL,hasChild:!!e.invertedList&&e.invertedList.length>0,"row-city__bgcolor":e.level==t.CITY,"row-district__bgcolor":e.level==t.DISTRICT}],on:{click:function(a){return t.openSchoolInfo(a,e)}}},[n("tr",[n("td",{attrs:{rowspan:t.rowMerge(e)}},[t._v(t._s(e.sort))]),t._v(" "),n("td",{attrs:{rowspan:t.rowMerge(e)}},[t._v(t._s(e.schoolName))]),t._v(" "),n("td",{attrs:{rowspan:t.rowMerge(e)}},[t._v(t._s(e.schoolType))]),t._v(" "),n("td",{attrs:{rowspan:t.rowMerge(e)}},[t._v(t._s(e.area))]),t._v(" "),n("td",{attrs:{rowspan:t.rowMerge(e)}},[t._v(t._s(e.newBuild))]),t._v(" "),n("td",{attrs:{rowspan:t.rowMerge(e)}},[t._v(t._s(e.invest))]),t._v(" "),n("td",[t._v(t._s(e.startYear))]),t._v(" "),n("td",[t._v(t._s(e.endYear))]),t._v(" "),t._l(t.tMenu,function(a,s){return n("td",{key:s},[e.level==t.CITY||e.level==t.DISTRICT?n("span",[t._v(t._s(null!=e.scheduleList[s]&&null!=e.scheduleList[s].count?e.scheduleList[s].count:""))]):a.id===e.schedule?n("i",{staticClass:"el-icon-star-on",staticStyle:{color:"#f54b10"}}):t._e()])}),t._v(" "),n("td",[t._v(t._s(e.allInvest))]),t._v(" "),n("td",{attrs:{rowspan:t.rowMerge(e)}},[t._v(t._s(e.zrdw))]),t._v(" "),n("td",{attrs:{rowspan:t.rowMerge(e)}},[t._v(t._s(e.lxld))]),t._v(" "),n("td",{attrs:{rowspan:t.rowMerge(e)}},[t._v(t._s(e.zfz))])],2),t._v(" "),e.invertedList&&e.invertedList.length>0?n("tr",{class:[{hide:t.showSchoolInfo},"school-info_"+e.id]},[n("td",[t._v("重点说明情况：")]),t._v(" "),n("td",{attrs:{colspan:e.invertedList.length}},[t._v(t._s(e.reward))])]):t._e(),t._v(" "),e.invertedList&&e.invertedList.length>0?n("tr",{class:[{hide:t.showSchoolInfo},"school-info_"+e.id]},[n("td",{attrs:{rowspan:"2"}},[t._v("倒排时间节点：")]),t._v(" "),t._l(e.invertedList,function(e,a){return n("td",{key:a},[t._v(t._s(e.name))])})],2):t._e(),t._v(" "),e.invertedList&&e.invertedList.length>0?n("tr",{class:[{hide:t.showSchoolInfo},"school-info_"+e.id]},t._l(e.invertedList,function(e,a){return n("td",{key:a},[t._v(t._s(t._f("YMD")(e.time)))])}),0):t._e()])})],2)]):t._e(),t._v(" "),t.toggleProject?n("v-toggle-project",{ref:"toggleProject",attrs:{show:t.toggleProject,data:{data:t.projectData}},on:{"update:show":function(e){t.toggleProject=e}}}):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("th",{attrs:{rowspan:"2"}},[this._v("累计完成投资"),e("br"),this._v("（万元）")])},function(){var t=this.$createElement,e=this._self._c||t;return e("th",[this._v("规划总投资"),e("br"),this._v("（万元）")])}]};var c=a("VU/8")(l,i,!1,function(t){a("rHH3"),a("s+3A")},"data-v-68d3b91f",null);e.default=c.exports},rGGE:function(t,e){},rHH3:function(t,e){},"s+3A":function(t,e){}});
//# sourceMappingURL=5.487036d43e7f401bf40e.js.map