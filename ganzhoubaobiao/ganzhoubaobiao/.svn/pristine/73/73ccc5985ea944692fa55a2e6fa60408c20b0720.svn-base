webpackJsonp([21],{RHAa:function(e,t){},qMDP:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("3cXf"),o=s.n(a),i={data:function(){return{name:"",dateValue:"",startDate:"",endtDate:"",form:{startYear:"",endYear:"",area:"",newBuild:"",schoolName:"",reward:"",fileStr:"",projectId:this.$route.params.projectId,townId:sessionStorage.getItem("townId"),id:this.$route.params.schoolId,schoolType:"",invest:""},removeFlag:!0,value:"",dialogImageUrl:"",dialogVisible:!1,fileList:[],projectName:this.$route.params.projectName,startTime:this.$route.params.startTime,endTime:this.$route.params.endTime,schoolTypeList:[]}},mounted:function(){var e=this;this.$nextTick(function(){console.log(e.$route.params.schoolId),null!=e.form.id&&""!=e.form.id&&(e.initSchoolInfo(),e.initSchoolFile()),e.querySchoolType()})},computed:{fileLists:function(){var e=[];return this.fileList.forEach(function(t,s){e.push({name:t.fileName,url:t.fileUrl})}),console.log(e),e}},methods:{quxiao:function(){this.$router.push({name:"CountyProjectDetail",params:{projectId:this.form.projectId}})},querySchoolType:function(){var e=this;this.$post("/web/queryDic",{pcode:"101"}).then(function(t){e.schoolTypeList=t.content.list,e.schoolTypeList.unshift({code:"",name:"全部"})})},save:function(){var e=this;this.form.fileStr=o()(this.fileList),""!=this.form.schoolName?""!=this.form.schoolType?""!=this.form.invest?""!=this.form.startYear?""!=this.form.endYear?""!=this.form.area?""!=this.form.newBuild?this.$post("/web/addSchool",this.form).then(function(t){0==t.resultCode&&(e.$message({message:"创建成功!",type:"success"}),e.quxiao())}):this.$message({message:"新建学位不能为空!"}):this.$message({message:"建筑面积不能为空!"}):this.$message({message:"竣工年份不能为空!"}):this.$message({message:"开工年份不能为空!"}):this.$message({message:"计划投资不能为空!"}):this.$message({message:"学校类型不能为空!"}):this.$message({message:"学校名称不能为空!"})},initSchoolInfo:function(){var e=this;this.$post("/web/queryOneSchool",{id:e.form.id}).then(function(t){0==t.resultCode&&(e.form=t.content.school)})},initSchoolFile:function(){var e=this;this.$post("/web/queryOneSchoolFile",{id:e.form.id}).then(function(t){0==t.resultCode&&(e.fileList=t.content.schoolFile)})},handleRemove:function(e,t){if(this.removeFlag){var s=this.fileLists.indexOf(e);this.fileLists.splice(s,1),this.fileList.splice(s,1)}},handlePictureCardPreview:function(e){console.log("handlePictureCardPreview"),this.dialogImageUrl=e.url,this.dialogVisible=!0},newhandlesuccess:function(e,t){if(console.log("newhandlesuccess",e),0==e.resultCode)this.fileList.push({fileName:e.content.fileName,fileUrl:e.content.fileUrl}),console.log("newhandlesuccess",this.fileList);else if("tolarge"==e.resultCode){this.$message("文件大小不能超过50M");var s=this.fileLists.indexOf(e);return this.fileLists.splice(s,1),void this.fileList.splice(s,1)}},beforeUpload:function(e){var t=e.size/1024/1024<512,s=this.fileLists.some(function(t){return t.name===e.name});return t||this.$message.error("上传文件大小不能超过 512MB!"),this.removeFlag=t&&!s,t&&!s}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"county-project__create-school plate"},[s("div",{staticClass:"pandect plate-top"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{staticClass:"margin-bottom__medium",attrs:{span:12}},[e._v("\n          "+e._s(e.projectName)+"\n        ")]),e._v(" "),s("el-col",{staticClass:"clearfix margin-bottom__medium",attrs:{span:12}},[s("el-date-picker",{staticClass:"year-date",attrs:{type:"year",placeholder:"开工年份",disabled:""},model:{value:e.startTime,callback:function(t){e.startTime=t},expression:"startTime"}}),e._v(" "),s("el-date-picker",{staticClass:"year-date",attrs:{type:"year",placeholder:"竣工年份",disabled:""},model:{value:e.endTime,callback:function(t){e.endTime=t},expression:"endTime"}})],1)],1)],1),e._v(" "),s("div",{staticClass:"plate-top"},[s("el-form",{attrs:{"label-width":"70px"}},[s("el-row",{attrs:{gutter:15}},[s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"学校名称"}},[s("el-input",{attrs:{maxlength:"50"},model:{value:e.form.schoolName,callback:function(t){e.$set(e.form,"schoolName",t)},expression:"form.schoolName"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"学校类型"}},[s("el-select",{attrs:{placeholder:"学校类型"},model:{value:e.form.schoolType,callback:function(t){e.$set(e.form,"schoolType",t)},expression:"form.schoolType"}},e._l(e.schoolTypeList,function(e){return s("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})}),1)],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"计划投资"}},[s("el-input-number",{attrs:{precision:2,max:1e6,controls:!1,size:"large"},model:{value:e.form.invest,callback:function(t){e.$set(e.form,"invest",t)},expression:"form.invest"}})],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:15}},[s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"开工年份"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"year",placeholder:"选择年","value-format":"yyyy"},model:{value:e.form.startYear,callback:function(t){e.$set(e.form,"startYear",t)},expression:"form.startYear"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"竣工年份"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"year",placeholder:"选择年","value-format":"yyyy"},model:{value:e.form.endYear,callback:function(t){e.$set(e.form,"endYear",t)},expression:"form.endYear"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"建筑面积"}},[s("el-input-number",{attrs:{precision:2,max:1e6,controls:!1,size:"large"},model:{value:e.form.area,callback:function(t){e.$set(e.form,"area",t)},expression:"form.area"}})],1)],1),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-form-item",{attrs:{label:"新增学位"}},[s("el-input-number",{attrs:{precision:0,max:1e6,controls:!1,size:"large"},model:{value:e.form.newBuild,callback:function(t){e.$set(e.form,"newBuild",t)},expression:"form.newBuild"}})],1)],1)],1)],1)],1),e._v(" "),s("div",{staticClass:"plate-bottom has-padding"},[s("el-form",{attrs:{"label-width":"70px"}},[s("el-form-item",{attrs:{label:"重点说明"}},[s("el-input",{attrs:{type:"textarea",maxlength:"100"},model:{value:e.form.reward,callback:function(t){e.$set(e.form,"reward",t)},expression:"form.reward"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"上传资质"}},[s("el-upload",{attrs:{action:"/ganzhoubaobiao/web/uploadFile","list-type":"picture-card","file-list":e.fileLists,"on-success":e.newhandlesuccess,"on-remove":e.handleRemove}},[s("i",{staticClass:"el-icon-plus"})]),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),e._v(" "),s("el-form-item",{staticClass:"text-right"},[s("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确定")]),e._v(" "),s("el-button",{on:{click:e.quxiao}},[e._v("取消")])],1)],1)],1)])},staticRenderFns:[]};var r=s("C7Lr")(i,l,!1,function(e){s("RHAa")},null,null);t.default=r.exports}});
//# sourceMappingURL=21.3793f79c7a07c52459c7.js.map