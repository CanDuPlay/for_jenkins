webpackJsonp([9],{BVja:function(e,t){},pAHt:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"user-auth__wrapper plate"},[s("div",{staticClass:"plate-alone"},[e._m(0),e._v(" "),s("table",{staticClass:"user-auth__check"},[s("tbody",[e._m(1),e._v(" "),s("tr",[s("td",[e._v("是否审核")]),e._v(" "),e._l(e.arr,function(t,i){return s("td",{key:i,staticClass:"has-bar"},[s("el-checkbox",{on:{change:function(s){return e.setAuditAuthority(t)}},model:{value:t.checked,callback:function(s){e.$set(t,"checked",s)},expression:"item.checked"}})],1)})],2)])])]),e._v(" "),s("div",{staticClass:"plate-alone"},[s("p",{staticClass:"plate-alone__title"},[e._v("帐号权限管理")]),e._v(" "),s("el-form",{attrs:{inline:""}},[s("el-form-item",[s("el-select",{staticStyle:{width:"130px"},attrs:{clearable:"",placeholder:"姓名"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}},e._l(e.tTeacherList,function(e,t){return s("el-option",{key:e.globalId,attrs:{label:e.name,value:e.globalId}})}),1)],1),e._v(" "),s("el-form-item",[s("el-select",{staticStyle:{width:"140px"},attrs:{clearable:"",placeholder:"选择权限"},model:{value:e.roleName,callback:function(t){e.roleName=t},expression:"roleName"}},e._l(e.roleList,function(e,t){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),s("el-form-item",[s("el-select",{staticStyle:{width:"180px"},attrs:{clearable:"",placeholder:"归属区县"},model:{value:e.townName,callback:function(t){e.townName=t},expression:"townName"}},e._l(e.townList,function(e){return s("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})}),1)],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.saveAccountAuthority}},[e._v("创建")])],1)],1),e._v(" "),s("section",{staticClass:"margin-bottom__medium",staticStyle:{"margin-left":"-25px","margin-right":"-25px"}},[s("el-table",{staticClass:"first-cell__left",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[s("el-table-column",{attrs:{type:"index",label:"序号",width:"80"}}),e._v(" "),s("el-table-column",{attrs:{label:"姓名",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.isEdit?s("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:i.userId,callback:function(t){e.$set(i,"userId",t)},expression:"row.userId"}},e._l(e.tTeacherList,function(e){return s("el-option",{key:e.globalId,attrs:{label:e.name,value:e.globalId}})}),1):s("span",[e._v(e._s(i.userName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"权限",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.isEdit?s("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:i.roleId,callback:function(t){e.$set(i,"roleId",t)},expression:"row.roleId"}},e._l(e.roleList,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1):s("span",[e._v(e._s(i.roleName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"归属区县",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.isEdit?s("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:i.townId,callback:function(t){e.$set(i,"townId",t)},expression:"row.townId"}},e._l(e.townList,function(e){return s("el-option",{key:e.code,attrs:{label:e.name,value:e.code}})}),1):s("span",[e._v(e._s(i.townName))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row,a=t.$index;return[i.isEdit?s("div",[s("el-button",{staticClass:"close text-btn",attrs:{type:"text",icon:"el-icon-circle-close"},on:{click:function(t){return e.cancelClose(i,a)}}}),e._v(" "),s("el-button",{staticClass:"check text-btn",attrs:{type:"text",icon:"el-icon-circle-check"},on:{click:function(t){return e.finish(i,a)}}})],1):s("el-button",{attrs:{icon:"el-icon-edit"},on:{click:function(t){return e.queryAccountAuthorityById(a)}}}),e._v(" "),i.isEdit?e._e():s("el-button",{attrs:{icon:"el-icon-delete"},on:{click:function(t){return e.deleteAccountAuthority(i.id)}}})]}}])})],1)],1),e._v(" "),e.userRoleList.totalPages>0?s("el-pagination",{staticClass:"is-background-white text-center",attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.userRoleList.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticClass:"plate-alone__title"},[this._v("\n        审核权限设置\n        "),t("span",{staticClass:"hint-tip"},[this._v("逐级提交，审核后显示，仅限当月操作，过期已操作无法变更。")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("tr",[s("td",{attrs:{width:"80"}}),e._v(" "),s("td",[s("div",{staticClass:"need-check need-check__1"},[e._v("区县校建办")])]),e._v(" "),s("td",[s("div",{staticClass:"need-check need-check__1"},[e._v("区县校建主任")])]),e._v(" "),s("td",[s("div",{staticClass:"need-check need-check__1"},[e._v("区县分管局长")])]),e._v(" "),s("td",[s("div",{staticClass:"need-check need-check__1"},[e._v("区县局长")])]),e._v(" "),s("td",[s("div",{staticClass:"need-check need-check__2"},[e._v("市局科室")])]),e._v(" "),s("td",[s("div",{staticClass:"need-check need-check__2"},[e._v("市局科室负责")])]),e._v(" "),s("td",[s("div",{staticClass:"need-check need-check__2"},[e._v("市局分管领导")])]),e._v(" "),s("td",[s("div",{staticClass:"need-check need-check__2"},[e._v("市局局长")])]),e._v(" "),s("td",[s("div",{staticClass:"need-check need-check__3"},[e._v("市分管领导")])])])}]};var a=s("C7Lr")({data:function(){return{arr:[{id:110001,status:1,checked:!1},{id:110002,status:2,checked:!1},{id:110003,status:3,checked:!1},{id:110004,status:4,checked:!1},{id:110005,status:5,checked:!1},{id:110006,status:6,checked:!1},{id:110007,status:7,checked:!1},{id:110008,status:8,checked:!1},{id:110009,status:9,checked:!1}],value:"",options:[],tableData:[],userName:"",roleName:"",townName:"",pageSize:10,currentPage:1,roleList:[],townList:[],tTeacherList:[],userRoleList:[]}},mounted:function(){this.queryAllTown(),this.queryAllTeacher(),this.queryAllAuthority(),this.queryAccountAuthorityList()},methods:{queryAllTown:function(){var e=this;this.$post("/admin/queryAllTown").then(function(t){e.townList=t.content.townList})},queryAllTeacher:function(){var e=this;this.$post("/admin/queryAllTeacher").then(function(t){e.tTeacherList=t.content.tTeacherList})},queryAllAuthority:function(){var e=this;this.$post("/admin/queryAllAuthority").then(function(t){e.roleList=t.content.roleList,e.roleList.forEach(function(t,s){1===t.ifCheck&&(e.arr[s].checked=!0)})})},queryAccountAuthorityList:function(){var e=this;this.$post("/admin/queryAccountAuthorityList",{page:this.currentPage-1,size:this.pageSize}).then(function(t){e.userRoleList=t.content.page,e.tableData=t.content.page.content})},saveAccountAuthority:function(){var e=this;return this.userName?this.roleName?!this.townName&&this.roleName<"110005"?this.$message({showClose:!0,type:"error",message:"请选择归属区县！"}):void this.$post("/admin/saveAccountAuthority",{name:this.userName,roleName:this.roleName,townName:this.townName}).then(function(t){0==t.resultCode?(e.$message({showClose:!0,type:"success",message:"操作成功！"}),e.userName="",e.roleName="",e.townName="",e.queryAccountAuthorityList()):-1==t.resultCode&&e.$message({showClose:!0,type:"error",message:t.resultDesc})}):this.$message({showClose:!0,type:"error",message:"请选择权限！"}):this.$message({showClose:!0,type:"error",message:"请选择人员名称！"})},setAuditAuthority:function(e){var t=this,s=void 0;s=e.checked?1:0,this.$post("/admin/auditAuthoritySet",{id:e.id,ifCheck:s}).then(function(e){0==e.resultCode?t.$message({showClose:!0,type:"success",message:"操作成功！"}):t.$message({showClose:!0,type:"warning",message:"操作失败，请联系管理员！"})})},queryAccountAuthorityById:function(e){var t=this;this.tableData.forEach(function(s,i){e==i?void 0===s.isEdit?t.$set(s,"isEdit",!0):s.isEdit=!s.isEdit:(void 0===s.isEdit&&t.$set(s,"isEdit",!1),s.isEdit&&(s.isEdit=!s.isEdit))})},finish:function(e,t){var s=this;this.$post("/admin/saveAccountAuthority",{id:e.id,name:e.userId,roleName:e.roleId,townName:e.townId}).then(function(e){0==e.resultCode&&s.$message({showClose:!0,type:"success",message:"操作成功！"}),s.queryAccountAuthorityList()})},cancelClose:function(e,t){var s=this.tableData[t];void 0===s.isEdit?this.$set(s,"isEdit",!0):s.isEdit=!s.isEdit},deleteAccountAuthority:function(e){var t=this;this.$confirm("删除后将无法恢复，确定删除该数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$post("/admin/deleteAccountAuthority",{id:e}).then(function(e){0==e.resultCode&&t.$message({showClose:!0,type:"success",message:"操作成功！"}),t.queryAccountAuthorityList()})}).catch(function(){t.$message({showClose:!0,type:"info",message:"已取消删除！"})})},handleSizeChange:function(e){this.currentPage=1,this.pageSize=e,this.queryAccountAuthorityList()},handleCurrentChange:function(e){this.currentPage=e,this.queryAccountAuthorityList()}}},i,!1,function(e){s("BVja")},null,null);t.default=a.exports}});
//# sourceMappingURL=9.10ec1e3e6db2e032f4e1.js.map