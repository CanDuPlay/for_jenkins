webpackJsonp([19],{"00Lw":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("mvHQ"),n=a.n(s),i=(Boolean,["#fee9e9","#e1f5fe","#e8f6ed"]),l={data:function(){return{tableData:[],list:[],townId:sessionStorage.getItem("townId")}},computed:{isShow:{get:function(){return this.show},set:function(t){this.$emit("update:show",t)}}},props:{show:{type:Boolean,default:!1},data:{}},mounted:function(){var t=this;this.$nextTick(function(){t.init()})},methods:{init:function(){var t=this;this.$post("/web/queryProjectSchedule",{projectId:this.data.id,townId:this.townId}).then(function(e){0==e.resultCode&&(t.list=e.content.list,t.getSpanArr(t.list))})},saveData:function(){var t=this;console.log(this.list),this.$post("/web/saveTownProjectTime",{projectTime:n()(this.list),townId:this.townId}).then(function(e){0==e.resultCode&&(t.$message({type:"success",message:"项目时间更新成功！"}),t.isShow=!1)})},getSpanArr:function(t){this._spanArr=[];for(var e=0;e<t.length;e++)0===e?(this._spanArr.push(1),this._pos=0):t[e].id===t[e-1].id?(this._spanArr[this._pos]+=1,this._spanArr.push(0)):(this._spanArr.push(1),this._pos=e)},arraySpanMethod:function(t){t.row,t.column;var e=t.rowIndex;if(0===t.columnIndex){var a=this._spanArr[e];return{rowspan:a,colspan:a>0?1:0}}},setCellStyle:function(t){t.row,t.column,t.rowIndex;if(0===t.columnIndex)return void 0===this._index?this._index=0:this._index++,{backgroundColor:i[this._index%3]}}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"common-modal",attrs:{title:"设置项目时间",visible:t.isShow},on:{"update:visible":function(e){t.isShow=e}}},[t.list.length?a("el-table",{staticStyle:{width:"100%"},attrs:{id:"tables",data:t.list,stripe:"","span-method":t.arraySpanMethod,"cell-style":t.setCellStyle,"header-row-class-name":"table-head-height"}},[a("el-table-column",{attrs:{prop:"stage",label:"阶段",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"scheduleName",label:"进度"}}),t._v(" "),a("el-table-column",{attrs:{label:"项目计划",width:"360"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:s.dateTime,callback:function(e){t.$set(s,"dateTime",e)},expression:"row.dateTime"}})]}}],null,!1,2973558050)})],1):t._e(),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.saveData}},[t._v("确认提交")]),t._v(" "),a("el-button",{on:{click:function(e){t.isShow=!1}}},[t._v("取消")])],1)],1)},staticRenderFns:[]},r=a("VU/8")(l,o,!1,null,null,null).exports,c={components:{vSetTimeDialog:r},data:function(){return{value:"",options:[{value:"选项1",label:"黄金糕"},{value:"选项2",label:"双皮奶"}],tableData:[{date:"2016-05-03",name:"王小虎",address:"上海市普陀区金沙江路 1516 弄",contact:"赵四<br/>13812345678"},{date:"2016-05-03",name:"王小虎",address:"上海市普陀区金沙江路 1516 弄",contact:"赵四<br/>13812345678"},{date:"2016-05-03",name:"王小虎",address:"上海市普陀区金沙江路 1516 弄",contact:"赵四<br/>13812345678"}],statusOptions:[{value:"",label:"全部"},{value:"1",label:"未开始"},{value:"2",label:"进行中"},{value:"3",label:"已完成"}],dialogVisible:!1,dialogTextarea:"",yearList:[],year:"",status:"",projectName:"",page:[],pageSize:10,currentPage:1,roleId:sessionStorage.getItem("roleId"),townId:sessionStorage.getItem("townId"),setTimeDialog:!1,data:{}}},mounted:function(){this.$nextTick(function(){this.initYear(),this.init()})},methods:{init:function(){var t=this;this.$post("/web/queryProjectList",{year:this.year,status:this.status,projectName:this.projectName,page:this.currentPage-1,size:this.pageSize,townId:this.townId}).then(function(e){0==e.resultCode&&(t.page=e.content.page)})},initYear:function(){var t=this;this.$post("/web/queryProjectYears",{}).then(function(e){0==e.resultCode&&(t.yearList=e.content.list)})},handleSizeChange:function(t){this.currentPage=1,this.pageSize=t,this.init()},handleCurrentChange:function(t){this.currentPage=t,this.init()},setTownTime:function(t){this.data.id=t,this.setTimeDialog=!0},turnPage:function(t,e){sessionStorage.setItem("projectId",e.id),sessionStorage.setItem("projectName",e.name),this.$router.push({name:t,params:{projectId:e.id,projectName:e.name}})}}},u={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"county-wrapper plate"},[s("div",{staticClass:"table-wrapper plate-bottom has-padding"},[s("el-form",{staticClass:"clearfix",attrs:{inline:""}},[s("el-form-item",[s("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:t.year,callback:function(e){t.year=e},expression:"year"}},t._l(t.yearList,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),s("el-form-item",[s("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择"},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},t._l(t.statusOptions,function(t){return s("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),s("el-form-item",[s("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"关键词查询"},model:{value:t.projectName,callback:function(e){t.projectName=e},expression:"projectName"}})],1),t._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.init()}}},[t._v("查询")])],1),t._v(" "),s("el-form-item",{staticClass:"pull-right"},[s("el-popover",{staticStyle:{"margin-right":"10px"},attrs:{placement:"bottom",width:"200",trigger:"click"}},[s("img",{attrs:{src:a("7Otq"),alt:""}})])],1)],1),t._v(" "),s("el-table",{staticClass:"margin-bottom__small first-cell__left",staticStyle:{width:"100%"},attrs:{data:t.page.content}},[s("el-table-column",{attrs:{type:"index",label:"序号",width:"70"}}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"项目名称",align:"center"}}),t._v(" "),s("el-table-column",{attrs:{label:"建设时段",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[t._v("\n          \t"+t._s(t._f("YYYYMM")(a.startTime))+" - "+t._s(t._f("YYYYMM")(a.endTime))+"\n          ")]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[2==a.status?s("span",{staticClass:"state-style is-state__1-text"},[t._v("进行中")]):t._e(),t._v(" "),1==a.status?s("span",{staticClass:"state-style is-state__3-text"},[t._v("未开始")]):t._e()]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"操作",width:"210",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[110001==t.roleId?s("el-button",{attrs:{type:"text"},on:{click:function(e){return t.turnPage("CountyProjectDetail",a)}}},[t._v("维护项目学校")]):s("el-button",{attrs:{type:"text"},on:{click:function(e){return t.turnPage("CountyCheckInfo",a)}}},[t._v("查看核实")])]}}])})],1),t._v(" "),t.page.totalPages>0?s("el-pagination",{staticClass:"text-center",attrs:{"current-page":t.currentPage,"page-sizes":[10,20,30,40,50],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.page.totalElements},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}):t._e()],1),t._v(" "),t.setTimeDialog?s("v-set-time-dialog",{ref:"setTimeDialog",attrs:{show:t.setTimeDialog,data:t.data},on:{"update:show":function(e){t.setTimeDialog=e}}}):t._e()],1)},staticRenderFns:[]};var d=a("VU/8")(c,u,!1,function(t){a("gk4o")},null,null);e.default=d.exports},gk4o:function(t,e){}});
//# sourceMappingURL=19.acacc4456da433b6cc29.js.map