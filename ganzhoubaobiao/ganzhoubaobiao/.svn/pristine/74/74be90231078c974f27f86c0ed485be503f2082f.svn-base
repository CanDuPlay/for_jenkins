webpackJsonp([29],{s5bP:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l={data:function(){return{id:sessionStorage.getItem("DataCollectionID"),dataCollect:{id:"",title:"",instruction:"",fileUrl:"",fileName:"",remindWay:[],remindContent:""},fileList:[]}},mounted:function(){this.id&&this.findDataCollectById()},methods:{findDataCollectById:function(){var t=this;this.$post("/admin/findDataCollectById",{id:this.id}).then(function(e){var a=[],l=e.content.tDataCollect;l.remindWay.split(",").forEach(function(t,e){a.push(t)}),t.dataCollect.id=l.id,t.dataCollect.title=l.title,t.dataCollect.instruction=l.instruction,t.dataCollect.fileUrl=l.fileUrl,t.dataCollect.fileName=l.fileName,t.dataCollect.remindWay=a,t.dataCollect.remindContent=l.remindContent;var i={};i.name=l.fileName,i.url=l.fileUrl,t.fileList.push(i)})},saveData:function(){var t=this;return this.dataCollect.title?this.dataCollect.instruction?this.fileList.length<1?this.$message({showClose:!0,message:"请上传文件！",type:"error"}):this.dataCollect.remindWay.length<1?this.$message({showClose:!0,message:"请选择提醒方式！",type:"error"}):this.dataCollect.remindContent?(this.dataCollect.remindWay=this.dataCollect.remindWay.join(","),void this.$post("/admin/saveDataCollect",this.dataCollect).then(function(e){0==e.resultCode&&t.$message({showClose:!0,type:"success",message:"操作成功！"}),t.$router.push({path:"/DataCollection"})})):this.$message({showClose:!0,message:"请输入提醒内容！",type:"error"}):this.$message({showClose:!0,message:"请输入说明！",type:"error"}):this.$message({showClose:!0,message:"请输入标题！",type:"error"})},uploadSuccess:function(t,e,a){this.dataCollect.fileUrl=e.response.content.fileInfo,this.dataCollect.fileName=e.response.content.fileName,this.fileList=a},handleRemove:function(t,e){this.fileList=[]},handleExceed:function(t,e){this.$message({showClose:!0,type:"warning",message:"当前限制只能上传一个文件，先删除原文件再重新上传。"})},beforeRemove:function(t,e){return this.$confirm("确定删除 "+t.name+"？")},viewData:function(){this.$post("/admin/viewDataCollect",{id:this.id}).then(function(t){})}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"data-collection__edit plate"},[a("div",{staticClass:"plate-title clearfix"},[a("span",[t._v("创建内容")]),t._v(" "),a("section",{staticClass:"pull-right"},[a("el-button",{attrs:{type:"primary"},on:{click:t.viewData}},[t._v("预览")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:t.saveData}},[t._v("提交")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")])],1)]),t._v(" "),a("div",{staticClass:"plate-alone"},[a("el-form",{attrs:{"label-width":"90px"}},[a("el-form-item",{attrs:{label:"标题",required:""}},[a("el-input",{staticStyle:{width:"220px"},model:{value:t.dataCollect.title,callback:function(e){t.$set(t.dataCollect,"title",e)},expression:"dataCollect.title"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"说明",required:""}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4}},model:{value:t.dataCollect.instruction,callback:function(e){t.$set(t.dataCollect,"instruction",e)},expression:"dataCollect.instruction"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"导入表格",required:""}},[a("el-upload",{staticClass:"upload-demo",attrs:{name:"file",action:"/ganzhoubaobiao/admin/commonUpload","on-remove":t.handleRemove,"before-remove":t.beforeRemove,"on-success":t.uploadSuccess,limit:1,accept:".xls,.xlsx","on-exceed":t.handleExceed,"file-list":t.fileList}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传xls/xlsx文件")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"提醒方式",required:""}},[a("el-checkbox-group",{model:{value:t.dataCollect.remindWay,callback:function(e){t.$set(t.dataCollect,"remindWay",e)},expression:"dataCollect.remindWay"}},[a("el-checkbox",{attrs:{label:"1"}},[t._v("App 推送")]),t._v(" "),a("el-checkbox",{attrs:{label:"2"}},[t._v("短信通知")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"提醒内容",required:""}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4}},model:{value:t.dataCollect.remindContent,callback:function(e){t.$set(t.dataCollect,"remindContent",e)},expression:"dataCollect.remindContent"}})],1)],1)],1)])},staticRenderFns:[]},s=a("C7Lr")(l,i,!1,null,null,null);e.default=s.exports}});
//# sourceMappingURL=29.ca2e8436451a1bb12ae1.js.map