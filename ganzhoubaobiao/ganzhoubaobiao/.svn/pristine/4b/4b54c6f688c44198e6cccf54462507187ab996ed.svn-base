webpackJsonp([23],{"U/hQ":function(t,e){},gY9t:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("3cXf"),l=i.n(s),a=["#fee9e9","#e1f5fe","#e8f6ed"],o={data:function(){return{value:"",colors:a,planList:[{id:1,name:"未开工",type:1,currentPlan:1,list:[{label:"征地",value:1},{label:"图审",value:2}]},{id:2,name:"未开工",type:2,currentPlan:2,list:[{label:"征地",value:1},{label:"图审",value:2}]},{id:3,name:"未开工",type:3,currentPlan:1,list:[{label:"征地",value:1},{label:"图审",value:2}]}],dialogImageUrl:"",dialogVisible:!1,tableHistory:[{}],dialogTime:!1,projectId:this.$route.params.projectId,schoolId:this.$route.params.schoolId,schoolScheduleId:this.$route.params.schoolScheduleId,edit:this.$route.params.edit,townId:sessionStorage.getItem("townId"),schuledlist:[],form:{},fileList:[],fileStr:"",invest:"",nowSchedule:"",reward:"",daopaiList:[]}},computed:{fileLists:function(){var t=[];return this.fileList.forEach(function(e,i){t.push({name:e.fileName,url:e.fileUrl})}),t}},mounted:function(){var t=this;this.$nextTick(function(){t.init(),t.queryDaopaishijian()})},methods:{init:function(){var t=this;null!=this.schoolScheduleId&&""!=this.schoolScheduleId&&this.$post("/web/findSchoolSchedule",{id:this.schoolScheduleId}).then(function(e){if(0==e.resultCode){var i=e.content.tSchoolSchedule;t.nowSchedule=i.scheduleId+"",t.invest=i.invest,t.reward=i.reward,t.fileList=e.content.fileList}}),this.$post("/web/queryProjectSchedule",{projectId:this.projectId,townId:this.townId}).then(function(e){if(0==e.resultCode){var i=[];e.content.list.forEach(function(t,e){i.length&&t.id===i[i.length-1].id?i[i.length-1].list.push(t):(t.list=[t],i.push(t))}),t.schuledlist=i}})},save:function(){var t=this;this.fileStr=l()(this.fileList),""!=this.invest?isNaN(this.invest)?this.$vux.toast.show({text:"本月投入只能是数字!",width:"3rem"}):this.$post("/web/saveSchoolSchedule",{scheduleId:this.nowSchedule,schoolId:this.schoolId,invest:this.invest,reward:this.reward,fileStr:this.fileStr,id:this.schoolScheduleId}).then(function(e){t.$vux.toast.show({text:"申报成功!",width:"3rem"}),t.quxiao()}):this.$vux.toast.show({text:"本月投入不能为空!",width:"3rem"})},queryDaopaishijian:function(){var t=this;this.$post("/web/queryDaopaishijian",{schoolId:t.schoolId}).then(function(e){0==e.resultCode&&(t.daopaiList=e.content.list)})},changeState:function(t){var e=this;this.$post("/web/changeDaopaishijian",{id:t.id}).then(function(t){0==t.resultCode&&e.$vux.toast.show({text:"状态更新成功!",width:"3rem"})})},handleRemove:function(t,e){var i=this.fileLists.indexOf(t);this.fileLists.splice(i,1),this.fileList.splice(i,1)},handlePictureCardPreview:function(t){this.dialogImageUrl=t.url||t,this.dialogVisible=!0},newhandlesuccess:function(t,e){if(0==t.resultCode)this.fileList.push({fileName:t.content.fileName,fileUrl:t.content.fileUrl});else if("tolarge"==t.resultCode){this.$vux.toast.show({text:"文件大小不能超过50M!",width:"3rem"});var i=this.fileLists.indexOf(t);return this.fileLists.splice(i,1),void this.fileList.splice(i,1)}},quxiao:function(){localStorage.setItem("projectId",this.projectId),this.$router.push({name:"AppCountySchool"})}}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("app-view",[i("section",{staticClass:"plan-list__wrapper"},[i("p",{staticClass:"titles"},[t._v("进度情况")]),t._v(" "),t._l(t.schuledlist,function(e,s){return i("table",{key:s,staticClass:"plan-table"},[i("tr",{style:{"background-color":t.colors[s%3]}},[i("th",{staticClass:"text-left"},[t._v(t._s(e.stage))]),t._v(" "),i("th",[0==s?i("div",{staticClass:"time-icon__wrapper text-center pull-right"},[i("i",{staticClass:"el-icon-time",on:{click:function(e){t.dialogTime=!0}}})]):t._e()])]),t._v(" "),i("tr",[i("td",{attrs:{colspan:"2"}},t._l(e.list,function(e,s){return i("el-radio",{key:s,attrs:{label:e.scheduleId,border:""},model:{value:t.nowSchedule,callback:function(e){t.nowSchedule=e},expression:"nowSchedule"}},[t._v(t._s(e.scheduleName))])}),1)])])}),t._v(" "),i("table",{staticClass:"plan-table"},[i("tr",{staticStyle:{"background-color":"#e1f5fe"}},[i("th",{staticClass:"text-left"},[t._v("本月投入")])]),t._v(" "),i("tr",[i("td",[i("el-input",{attrs:{type:"textarea",autosize:{minRows:1}},model:{value:t.invest,callback:function(e){t.invest=e},expression:"invest"}})],1)])]),t._v(" "),i("table",{staticClass:"plan-table"},[i("tr",{staticStyle:{"background-color":"#e8f6ed"}},[i("th",{staticClass:"text-left"},[t._v("重点说明")])]),t._v(" "),i("tr",[i("td",[i("el-input",{attrs:{type:"textarea",autosize:{minRows:4}},model:{value:t.reward,callback:function(e){t.reward=e},expression:"reward"}})],1)]),t._v(" "),i("tr",[i("td",[i("el-upload",{attrs:{action:"/ganzhoubaobiao/web/uploadFile","file-list":t.fileLists,"list-type":"picture-card","on-success":t.newhandlesuccess,"on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove}},[i("i",{staticClass:"el-icon-plus"})]),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})]),t._v(" "),i("p",{staticClass:"hint-tip margin-top__small"},[t._v("本阶段所需资质：招标文件、施工图纸、招标控制价")])],1)])]),t._v(" "),i("div",{staticClass:"text-right margin-bottom__medium margin-right__medium"},["see"!=t.edit?i("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确定")]):t._e(),t._v(" "),"see"!=t.edit?i("el-button",{on:{click:t.quxiao}},[t._v("取消")]):i("el-button",{on:{click:t.quxiao}},[t._v("返回")])],1)],2),t._v(" "),i("el-dialog",{staticClass:"common-modal",attrs:{title:"未开工时间确认",visible:t.dialogTime,width:"95%"},on:{"update:visible":function(e){t.dialogTime=e}}},[i("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:t.daopaiList}},[i("el-table-column",{attrs:{prop:"name",label:"倒排工作项"}}),t._v(" "),i("el-table-column",{attrs:{label:"倒排时间节点",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return[i("span",{staticClass:"state-style is-state__1-text"},[t._v(t._s(t._f("YMD")(s.time)))])]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.row;return["see"!=t.edit&&1!=s.isFinish?i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.changeState(s)}}},[t._v("完成")]):1==s.isFinish?i("span",{staticClass:"state-style is-state__1-text"},[t._v("完成")]):t._e()]}}])})],1)],1)],1)},staticRenderFns:[]};var r=i("C7Lr")(o,n,!1,function(t){i("U/hQ")},"data-v-32908296",null);e.default=r.exports}});
//# sourceMappingURL=23.5b3857d04ab2eca509cc.js.map