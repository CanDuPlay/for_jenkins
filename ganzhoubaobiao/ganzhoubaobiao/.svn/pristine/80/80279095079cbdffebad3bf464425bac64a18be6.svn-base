webpackJsonp([29],{s5bP:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={data:function(){return{id:sessionStorage.getItem("DataCollectionID"),dataCollect:{id:"",title:"",instruction:"",fileUrl:"",fileName:"",remindWay:[],remindContent:""},fileList:[]}},mounted:function(){this.id&&this.findDataCollectById()},methods:{findDataCollectById:function(){var e=this;this.$post("/admin/findDataCollectById",{id:this.id}).then(function(t){var a=[],l=t.content.tDataCollect;l.remindWay.split(",").forEach(function(e,t){a.push(e)}),e.dataCollect.id=l.id,e.dataCollect.title=l.title,e.dataCollect.instruction=l.instruction,e.dataCollect.fileUrl=l.fileUrl,e.dataCollect.fileName=l.fileName,e.dataCollect.remindWay=a,e.dataCollect.remindContent=l.remindContent;var i={};i.name=l.fileName,i.url=l.fileUrl,e.fileList.push(i)})},saveData:function(){var e=this;return this.dataCollect.title?this.dataCollect.instruction?this.fileList.length<1?this.$message({showClose:!0,message:"请上传文件！",type:"error"}):this.dataCollect.remindWay.length<1?this.$message({showClose:!0,message:"请选择提醒方式！",type:"error"}):this.dataCollect.remindContent?(this.dataCollect.remindWay=this.dataCollect.remindWay.join(","),void this.$post("/admin/saveDataCollect",this.dataCollect).then(function(t){0==t.resultCode&&e.$message({showClose:!0,type:"success",message:"操作成功！"}),e.$router.push({path:"/DataCollection"})})):this.$message({showClose:!0,message:"请输入提醒内容！",type:"error"}):this.$message({showClose:!0,message:"请输入说明！",type:"error"}):this.$message({showClose:!0,message:"请输入标题！",type:"error"})},uploadSuccess:function(e,t,a){this.dataCollect.fileUrl=t.response.content.fileInfo,this.dataCollect.fileName=t.response.content.fileName,this.fileList=a},handleRemove:function(e,t){this.fileList=[]},handleExceed:function(e,t){this.$message({showClose:!0,type:"warning",message:"当前限制只能上传一个文件，先删除原文件再重新上传。"})},beforeRemove:function(e,t){return this.$confirm("确定删除 "+e.name+"？")},viewData:function(){sessionStorage.setItem("previewID",this.id),sessionStorage.setItem("previewFlag",!1),this.$router.push({name:"SubmitDataEdit"})}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"data-collection__edit plate"},[a("div",{staticClass:"plate-title clearfix"},[a("span",[e._v("创建内容")]),e._v(" "),a("section",{staticClass:"pull-right"},[e.id?a("el-button",{attrs:{type:"primary"},on:{click:e.viewData}},[e._v("预览")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:e.saveData}},[e._v("提交")]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")])],1)]),e._v(" "),a("div",{staticClass:"plate-alone"},[a("el-form",{attrs:{"label-width":"90px"}},[a("el-form-item",{attrs:{label:"标题",required:""}},[a("el-input",{staticStyle:{width:"220px"},model:{value:e.dataCollect.title,callback:function(t){e.$set(e.dataCollect,"title",t)},expression:"dataCollect.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"说明",required:""}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4}},model:{value:e.dataCollect.instruction,callback:function(t){e.$set(e.dataCollect,"instruction",t)},expression:"dataCollect.instruction"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"导入表格",required:""}},[a("el-upload",{staticClass:"upload-demo",attrs:{name:"file",action:"/ganzhoubaobiao/admin/commonUpload","on-remove":e.handleRemove,"before-remove":e.beforeRemove,"on-success":e.uploadSuccess,limit:1,accept:".xls,.xlsx","on-exceed":e.handleExceed,"file-list":e.fileList}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传xls/xlsx文件")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"提醒方式",required:""}},[a("el-checkbox-group",{model:{value:e.dataCollect.remindWay,callback:function(t){e.$set(e.dataCollect,"remindWay",t)},expression:"dataCollect.remindWay"}},[a("el-checkbox",{attrs:{label:"1"}},[e._v("App 推送")]),e._v(" "),a("el-checkbox",{attrs:{label:"2"}},[e._v("短信通知")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"提醒内容",required:""}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4}},model:{value:e.dataCollect.remindContent,callback:function(t){e.$set(e.dataCollect,"remindContent",t)},expression:"dataCollect.remindContent"}})],1)],1)],1)])},staticRenderFns:[]},s=a("C7Lr")(l,i,!1,null,null,null);t.default=s.exports}});
//# sourceMappingURL=29.7b94de45e9797bc100bd.js.map