webpackJsonp([28],{s5bP:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={data:function(){return{id:sessionStorage.getItem("DataCollectionID"),dataCollect:{id:"",title:"",instruction:"",fileUrl:"",fileName:"",remindWay:[],remindContent:""},fileList:[]}},mounted:function(){this.id&&this.findDataCollectById()},methods:{findDataCollectById:function(){var e=this;this.$post("/admin/findDataCollectById",{id:this.id}).then(function(t){var l=[],a=t.content.tDataCollect;a.remindWay.split(",").forEach(function(e,t){l.push(e)}),e.dataCollect.id=a.id,e.dataCollect.title=a.title,e.dataCollect.instruction=a.instruction,e.dataCollect.fileUrl=a.fileUrl,e.dataCollect.fileName=a.fileName,e.dataCollect.remindWay=l,e.dataCollect.remindContent=a.remindContent;var i={};i.name=a.fileName,i.url=a.fileUrl,e.fileList.push(i)})},saveData:function(){var e=this;return this.dataCollect.title?this.dataCollect.instruction?this.fileList.length<1?this.$message({showClose:!0,message:"请上传文件！",type:"error"}):this.dataCollect.remindWay.length<1?this.$message({showClose:!0,message:"请选择提醒方式！",type:"error"}):this.dataCollect.remindContent?(this.dataCollect.remindWay=this.dataCollect.remindWay.join(","),void this.$post("/admin/saveDataCollect",this.dataCollect).then(function(t){0==t.resultCode&&e.$message({showClose:!0,type:"success",message:"操作成功！"}),e.$router.push({path:"/DataCollection"})})):this.$message({showClose:!0,message:"请输入提醒内容！",type:"error"}):this.$message({showClose:!0,message:"请输入说明！",type:"error"}):this.$message({showClose:!0,message:"请输入标题！",type:"error"})},uploadSuccess:function(e,t,l){this.dataCollect.fileUrl=t.response.content.fileInfo,this.dataCollect.fileName=t.response.content.fileName,this.fileList=l},handleRemove:function(e,t){this.fileList=[]},handleExceed:function(e,t){this.$message({showClose:!0,type:"warning",message:"当前限制只能上传一个文件，先删除原文件再重新上传。"})},beforeRemove:function(e,t){return this.$confirm("确定删除 "+e.name+"？")}}},i={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("section",{staticClass:"data-collection__edit plate"},[l("div",{staticClass:"plate-title clearfix"},[l("span",[e._v("创建内容")]),e._v(" "),l("section",{staticClass:"pull-right"},[l("el-button",{attrs:{type:"primary"}},[e._v("预览")]),e._v(" "),l("el-button",{attrs:{type:"primary",plain:""},on:{click:e.saveData}},[e._v("提交")]),e._v(" "),l("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.$router.go(-1)}}},[e._v("返回")])],1)]),e._v(" "),l("div",{staticClass:"plate-alone"},[l("el-form",{attrs:{"label-width":"90px"}},[l("el-form-item",{attrs:{label:"标题",required:""}},[l("el-input",{staticStyle:{width:"220px"},model:{value:e.dataCollect.title,callback:function(t){e.$set(e.dataCollect,"title",t)},expression:"dataCollect.title"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"说明",required:""}},[l("el-input",{attrs:{type:"textarea",autosize:{minRows:4}},model:{value:e.dataCollect.instruction,callback:function(t){e.$set(e.dataCollect,"instruction",t)},expression:"dataCollect.instruction"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"导入表格",required:""}},[l("el-upload",{staticClass:"upload-demo",attrs:{name:"file",action:"/ganzhoubaobiao/admin/commonUpload","on-remove":e.handleRemove,"before-remove":e.beforeRemove,"on-success":e.uploadSuccess,limit:1,accept:".xls,.xlsx","on-exceed":e.handleExceed,"file-list":e.fileList}},[l("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),l("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传xls/xlsx文件")])],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"提醒方式",required:""}},[l("el-checkbox-group",{model:{value:e.dataCollect.remindWay,callback:function(t){e.$set(e.dataCollect,"remindWay",t)},expression:"dataCollect.remindWay"}},[l("el-checkbox",{attrs:{label:"1"}},[e._v("App 推送")]),e._v(" "),l("el-checkbox",{attrs:{label:"2"}},[e._v("短信通知")])],1)],1),e._v(" "),l("el-form-item",{attrs:{label:"提醒内容",required:""}},[l("el-input",{attrs:{type:"textarea",autosize:{minRows:4}},model:{value:e.dataCollect.remindContent,callback:function(t){e.$set(e.dataCollect,"remindContent",t)},expression:"dataCollect.remindContent"}})],1)],1)],1)])},staticRenderFns:[]},s=l("C7Lr")(a,i,!1,null,null,null);t.default=s.exports}});
//# sourceMappingURL=28.7d85747cb64c0a5560d8.js.map