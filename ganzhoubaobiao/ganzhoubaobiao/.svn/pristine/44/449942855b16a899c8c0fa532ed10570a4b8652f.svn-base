webpackJsonp([23],{gY9t:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("3cXf"),l=s.n(i),a=["#fee9e9","#e1f5fe","#e8f6ed"],o={data:function(){return{value:"",colors:a,planList:[{id:1,name:"未开工",type:1,currentPlan:1,list:[{label:"征地",value:1},{label:"图审",value:2}]},{id:2,name:"未开工",type:2,currentPlan:2,list:[{label:"征地",value:1},{label:"图审",value:2}]},{id:3,name:"未开工",type:3,currentPlan:1,list:[{label:"征地",value:1},{label:"图审",value:2}]}],dialogImageUrl:"",dialogVisible:!1,tableHistory:[{}],dialogTime:!1,projectId:this.$route.params.projectId,schoolId:this.$route.params.schoolId,schoolScheduleId:this.$route.params.schoolScheduleId,edit:this.$route.params.edit,townId:sessionStorage.getItem("townId"),schuledlist:[],form:{},fileList:[],fileStr:"",invest:"",nowSchedule:"",reward:"",daopaiList:[]}},computed:{fileLists:function(){var e=[];return this.fileList.forEach(function(t,s){e.push({name:t.fileName,url:t.fileUrl})}),e}},mounted:function(){var e=this;this.$nextTick(function(){e.init(),e.queryDaopaishijian()})},methods:{init:function(){var e=this;null!=this.schoolScheduleId&&""!=this.schoolScheduleId&&this.$post("/web/findSchoolSchedule",{id:this.schoolScheduleId}).then(function(t){if(0==t.resultCode){var s=t.content.tSchoolSchedule;e.nowSchedule=s.scheduleId+"",e.invest=s.invest,e.reward=s.reward,e.fileList=t.content.fileList}}),this.$post("/web/queryProjectSchedule",{projectId:this.projectId,townId:this.townId}).then(function(t){if(0==t.resultCode){var s=[];t.content.list.forEach(function(e,t){s.length&&e.id===s[s.length-1].id?s[s.length-1].list.push(e):(e.list=[e],s.push(e))}),e.schuledlist=s}})},save:function(){var e=this;this.fileStr=l()(this.fileList),""!=this.invest?(isNaN(this.invest)&&this.$message({message:"本月投入只能是数字!"}),this.$post("/web/saveSchoolSchedule",{scheduleId:this.nowSchedule,schoolId:this.schoolId,invest:this.invest,reward:this.reward,fileStr:this.fileStr,id:this.schoolScheduleId}).then(function(t){e.$message({type:"success",message:"申报成功!"}),e.quxiao()})):this.$message({message:"本月投入不能为空!"})},queryDaopaishijian:function(){var e=this;this.$post("/web/queryDaopaishijian",{schoolId:e.schoolId}).then(function(t){0==t.resultCode&&(e.daopaiList=t.content.list)})},changeState:function(e){var t=this;this.$post("/web/changeDaopaishijian",{id:e.id}).then(function(e){0==e.resultCode&&t.$message({type:"success",message:"状态更新成功!"})})},handleRemove:function(e,t){if(console.log("1",e),this.removeFlag){console.log(e);var s=this.fileLists.indexOf(e);this.fileLists.splice(s,1),this.fileList.splice(s,1)}console.log(t)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url||e,this.dialogVisible=!0},newhandlesuccess:function(e,t){if(0==e.resultCode)this.fileList.push({fileName:e.content.fileName,fileUrl:e.content.fileUrl});else if("tolarge"==e.resultCode){this.$message("文件大小不能超过50M");var s=this.fileLists.indexOf(e);return this.fileLists.splice(s,1),void this.fileList.splice(s,1)}},quxiao:function(){localStorage.setItem("projectId",this.projectId),this.$router.push({name:"AppCountySchool"})}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("app-view",[s("section",{staticClass:"plan-list__wrapper"},[s("p",{staticClass:"titles"},[e._v("进度情况")]),e._v(" "),e._l(e.schuledlist,function(t,i){return s("table",{key:i,staticClass:"plan-table"},[s("tr",{style:{"background-color":e.colors[i%3]}},[s("th",{staticClass:"text-left"},[e._v(e._s(t.stage))]),e._v(" "),s("th",[0==i?s("div",{staticClass:"time-icon__wrapper text-center pull-right"},[s("i",{staticClass:"el-icon-time",on:{click:function(t){e.dialogTime=!0}}})]):e._e()])]),e._v(" "),s("tr",[s("td",{attrs:{colspan:"2"}},e._l(t.list,function(t,i){return s("el-radio",{key:i,attrs:{label:t.scheduleId,border:""},model:{value:e.nowSchedule,callback:function(t){e.nowSchedule=t},expression:"nowSchedule"}},[e._v(e._s(t.scheduleName))])}),1)])])}),e._v(" "),s("table",{staticClass:"plan-table"},[s("tr",{staticStyle:{"background-color":"#e1f5fe"}},[s("th",{staticClass:"text-left"},[e._v("本月投入")])]),e._v(" "),s("tr",[s("td",[s("el-input",{model:{value:e.invest,callback:function(t){e.invest=t},expression:"invest"}})],1)])]),e._v(" "),s("table",{staticClass:"plan-table"},[s("tr",{staticStyle:{"background-color":"#e8f6ed"}},[s("th",{staticClass:"text-left"},[e._v("重点说明")])]),e._v(" "),s("tr",[s("td",[s("el-input",{attrs:{type:"textarea",autosize:{minRows:4}},model:{value:e.reward,callback:function(t){e.reward=t},expression:"reward"}})],1)]),e._v(" "),s("tr",[s("td",[s("el-upload",{attrs:{action:"/ganzhoubaobiao/web/uploadFile","file-list":e.fileLists,"list-type":"picture-card","on-success":e.newhandlesuccess,"on-preview":e.handlePictureCardPreview,"on-remove":e.handleRemove}},[s("i",{staticClass:"el-icon-plus"})]),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})]),e._v(" "),s("p",{staticClass:"hint-tip margin-top__small"},[e._v("本阶段所需资质：招标文件、施工图纸、招标控制价")])],1)])]),e._v(" "),s("div",{staticClass:"text-right margin-bottom__medium margin-right__medium"},["see"!=e.edit?s("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确定")]):e._e(),e._v(" "),"see"!=e.edit?s("el-button",{on:{click:e.quxiao}},[e._v("取消")]):s("el-button",{on:{click:e.quxiao}},[e._v("返回")])],1)],2),e._v(" "),s("el-dialog",{staticClass:"common-modal",attrs:{title:"未开工时间确认",visible:e.dialogTime,width:"95%"},on:{"update:visible":function(t){e.dialogTime=t}}},[s("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.daopaiList}},[s("el-table-column",{attrs:{prop:"name",label:"倒排工作项"}}),e._v(" "),s("el-table-column",{attrs:{label:"倒排时间节点",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[s("span",{staticClass:"state-style is-state__1-text"},[e._v(e._s(e._f("YMD")(i.time)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return["see"!=e.edit?s("el-button",{attrs:{type:"text"},on:{click:function(t){return e.changeState(i)}}},[e._v("完成")]):1==i.isFinish?s("span",{staticClass:"state-style is-state__1-text"},[e._v("完成")]):s("span",{staticClass:"state-style is-state__1-text"},[e._v("-")])]}}])})],1)],1)],1)},staticRenderFns:[]};var c=s("C7Lr")(o,n,!1,function(e){s("u5yT")},"data-v-29e2bde6",null);t.default=c.exports},u5yT:function(e,t){}});
//# sourceMappingURL=23.24816245a89fbe1caae4.js.map